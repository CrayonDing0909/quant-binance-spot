# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# RESEARCH ‚Äî Risk Mitigation Option B (Aggressive)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# Based on: config/prod_live_R3C_E3.yaml
# Created: 2026-02-24
# Trigger: /risk-review WARNING ‚Äî BTC concentration + alpha decay + high correlation
#
# CHANGES vs Baseline (prod_live_R3C_E3.yaml):
#   1. BTCUSDT weight: 0.8900 ‚Üí 0.4450 (revert 2x back to 1x)
#   2. Deweight 5 alpha-decaying alt symbols √ó 0.5:
#      - ETHUSDT:  0.3316 ‚Üí 0.1658
#      - XRPUSDT:  0.3026 ‚Üí 0.1513
#      - DOGEUSDT: 0.3156 ‚Üí 0.1578
#      - ADAUSDT:  0.3150 ‚Üí 0.1575
#      - LINKUSDT: 0.3316 ‚Üí 0.1658
#   3. Keep healthy/neutral symbols unchanged:
#      - SOLUSDT:  0.3137 (IC OK, IR=0.85)
#      - BNBUSDT:  0.4358 (IC‚âà0 but not decaying)
#      - AVAXUSDT: 0.3359 (IC OK, IR=0.63)
#      - LTCUSDT:  0.3729 (negative IC but stable)
#
# Weight sum: 3.94 ‚Üí 2.70 (effective ~2.7x multiplier)
# Strategy logic UNCHANGED
#
# RATIONALE:
#   Addresses all 3 WARNINGs:
#   - BTC concentration: 35% ‚Üí ~16% (via 1x revert)
#   - Alpha decay: penalize symbols with IC decay >50%
#   - High correlation: lower gross exposure reduces correlated risk
#
# RISK:
#   - Significant reduction in capital efficiency (~31% less gross)
#   - Lower expected return in bull markets
#   - Better tail risk protection in drawdown scenarios
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

market:
  symbols:
    - BTCUSDT
    - ETHUSDT
    - SOLUSDT
    - BNBUSDT
    - XRPUSDT
    - DOGEUSDT
    - ADAUSDT
    - AVAXUSDT
    - LINKUSDT
    - LTCUSDT
  interval: "1h"
  start: "2022-01-01"
  end: null
  market_type: "futures"

futures:
  leverage: 3
  margin_type: "ISOLATED"
  position_mode: "ONE_WAY"
  direction: "both"

strategy:
  name: "tsmom_ema"
  params:
    lookback: 168
    vol_target: 0.15
    ema_fast: 20
    ema_slow: 50
    agree_weight: 1.0
    disagree_weight: 0.3
  symbol_overrides: {}

  overlay:
    enabled: true
    mode: "oi_vol"
    params:
      oi_extreme_z: 999.0
      oi_reversal_window: 6
      reduce_pct: 0.5
      oi_lookback: 24
      oi_z_window: 168
      vol_spike_z: 2.0
      overlay_cooldown_bars: 12
      trend_lookback: 20
      atr_period: 14
      vol_z_window: 168

  micro_accel_overlay:
    enabled: true
    params:
      taker_window: 12
      vol_short_window: 12
      vol_long_window: 168
      ema_slope_period: 12
      ema_slope_norm_window: 48
      return_burst_window: 6
      oi_lookback: 24
      oi_z_window: 168
      w_taker: 0.30
      w_vol: 0.10
      w_slope: 0.25
      w_burst: 0.25
      w_oi: 0.10
      accel_threshold: 0.15
      decel_threshold: 0.15
      adverse_threshold: 0.45
      boost_pct: 0.45
      reduce_pct: 0.40
      size_floor: 0.10
      size_cap: 1.0
      cooldown_bars: 2
      adverse_exit_enabled: true
      adverse_exit_to: 0.0

ensemble:
  enabled: true
  weight_mode: "fixed"
  # Option B: BTC 1x + 5 decay alts √ó 0.5
  # Weight sum: 0.4450 + 0.1658 + 0.3137 + 0.4358 + 0.1513 + 0.1578
  #           + 0.1575 + 0.3359 + 0.1658 + 0.3729 = 2.7015
  fixed_weights:
    BTCUSDT: 0.4450    # CHANGED: 0.8900 ‚Üí 0.4450 (revert 2x)
    ETHUSDT: 0.1658    # CHANGED: 0.3316 √ó 0.5 (alpha decay)
    SOLUSDT: 0.3137    # unchanged (healthy IC)
    BNBUSDT: 0.4358    # unchanged (IC‚âà0 but stable)
    XRPUSDT: 0.1513    # CHANGED: 0.3026 √ó 0.5 (alpha decay)
    DOGEUSDT: 0.1578   # CHANGED: 0.3156 √ó 0.5 (alpha decay)
    ADAUSDT: 0.1575    # CHANGED: 0.3150 √ó 0.5 (alpha decay)
    AVAXUSDT: 0.3359   # unchanged (healthy IC)
    LINKUSDT: 0.1658   # CHANGED: 0.3316 √ó 0.5 (alpha decay)
    LTCUSDT: 0.3729    # unchanged (stable negative IC)
  vol_parity:
    lookback: 720
    min_weight: 0.03
    max_weight: 0.50

  strategies:
    BTCUSDT:
      name: "breakout_vol_atr"
      params:
        channel_period: 336
        channel_multiplier: 2.5
        atr_period: 14
        vol_fast_period: 14
        vol_slow_period: 72
        expansion_ratio: 1.1
        fake_breakout_bars: 6
        min_hold_bars: 24
        trail_exit_mid: true
        stop_loss_atr: 3.5
        max_holding_bars: 72
        cooldown_bars: 24
        vol_scale_enabled: true
        vol_scale_target: 99.0
        vol_scale_lookback: 168
        vol_scale_floor: 0.7
        vol_scale_cap: 0.7
        volume_confirm_enabled: true
        volume_confirm_period: 20
        volume_confirm_ratio: 1.5

    ETHUSDT:
      name: "tsmom_multi_ema"
      params:
        lookbacks: [72, 168, 336, 720]
        vol_target: 0.15
        ema_fast: 20
        ema_slow: 50
        agree_weight: 1.0
        disagree_weight: 0.3

backtest:
  initial_cash: 10000
  fee_bps: 5
  slippage_bps: 3
  trade_on: "next_open"
  validate_data: true
  clean_data: true
  funding_rate:
    enabled: true
    default_rate_8h: 0.0001
    use_historical: true
  slippage_model:
    enabled: false

risk:
  max_drawdown_pct: 0.40

position_sizing:
  method: "fixed"
  position_pct: 1.0

portfolio:
  cash_reserve: 0
  allocation:
    BTCUSDT: 0.4450    # CHANGED
    ETHUSDT: 0.1658    # CHANGED: √ó 0.5
    SOLUSDT: 0.3137
    BNBUSDT: 0.4358
    XRPUSDT: 0.1513    # CHANGED: √ó 0.5
    DOGEUSDT: 0.1578   # CHANGED: √ó 0.5
    ADAUSDT: 0.1575    # CHANGED: √ó 0.5
    AVAXUSDT: 0.3359
    LINKUSDT: 0.1658   # CHANGED: √ó 0.5
    LTCUSDT: 0.3729

notification:
  telegram_bot_token: ${FUTURES_TELEGRAM_BOT_TOKEN}
  telegram_chat_id: ${FUTURES_TELEGRAM_CHAT_ID}
  prefix: "üî¨ [RESEARCH-MitigationB]"
  enabled: false

output:
  report_dir: "./reports"
