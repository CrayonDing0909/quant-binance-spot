# åˆç´„ç­–ç•¥é…ç½®ï¼šBreakout + Volatility Expansion
#
# ç­–ç•¥åŸç†ï¼š
#   1. Donchian Channel çªç ´ â†’ è­˜åˆ¥ regime åˆ‡æ›èµ·é»
#   2. Volatility Expansion ç¢ºèª â†’ ATR å¿«å‡ç·š > æ…¢å‡ç·šæ‰å…¥å ´
#   3. Fake Breakout Filter â†’ çªç ´å¾Œå›è½è‡³é€šé“å…§å³å¹³å€‰
#   4. ä¸­è»Œæ­¢ç›ˆ + ATR æ­¢æ â†’ è¶¨å‹¢è·Ÿéš¨ç›´åˆ°å‹•èƒ½è¡°æ¸›
#
# è¨­è¨ˆæ€è·¯ï¼ˆèˆ‡ TSMOM æ­£äº¤ï¼‰ï¼š
#   - TSMOM æ•æ‰ã€Œå·²ç™¼ç”Ÿçš„è¶¨å‹¢ã€ï¼ˆé€£çºŒå‹•é‡ï¼‰
#   - Breakout æ•æ‰ã€Œregime åˆ‡æ›èµ·é»ã€ï¼ˆä½æ³¢è½‰é«˜æ³¢çš„èµ·çˆ†é»ï¼‰
#   - å…©è€…é€²å ´æ™‚æ©Ÿä¸åŒ â†’ ä½ç›¸é—œ â†’ çµ„åˆæœ‰æ•ˆ
#
# ä½¿ç”¨æ–¹å¼ï¼š
#   python scripts/download_data.py -c config/futures_breakout_vol.yaml
#   python scripts/run_backtest.py -c config/futures_breakout_vol.yaml
#   python scripts/run_backtest.py -c config/futures_breakout_vol.yaml --symbol BTCUSDT
#   python scripts/run_portfolio_backtest.py -c config/futures_breakout_vol.yaml
#   python scripts/run_walk_forward.py -c config/futures_breakout_vol.yaml --splits 5

market:
  symbols: ["BTCUSDT", "ETHUSDT", "SOLUSDT"]
  interval: "1h"
  start: "2022-01-01"
  end: null
  market_type: "futures"

futures:
  leverage: 3
  margin_type: "ISOLATED"
  position_mode: "ONE_WAY"
  direction: "both"

strategy:
  # å¯é¸ï¼šbreakout_volï¼ˆDonchianï¼‰æˆ– breakout_vol_atrï¼ˆATR Channelï¼‰
  name: "breakout_vol_atr"
  params:
    # â•â•â• ATR Channel â•â•â•
    channel_period: 336          # EMA å›çœ‹æœŸï¼ˆå°æ™‚ï¼‰ï¼Œ336 = 14 å¤©
    channel_multiplier: 2.5      # ATR å€æ•¸ï¼ˆé€šé“å¯¬åº¦ï¼‰
    
    # â•â•â• Volatility Expansion â•â•â•
    atr_period: 14               # ATR è¨ˆç®—é€±æœŸ
    vol_fast_period: 14          # ATR å¿«é€Ÿå‡å€¼ï¼ˆçŸ­æœŸæ³¢å‹•ï¼‰
    vol_slow_period: 72          # ATR æ…¢é€Ÿå‡å€¼ï¼ˆé•·æœŸåŸºæº–ï¼‰
    expansion_ratio: 1.1         # å¿«/æ…¢æ¯”ä¾‹é–€æª»ï¼ˆååš´æ ¼ï¼‰

    # â•â•â• Fake Breakout Filter â•â•â•
    fake_breakout_bars: 6        # çªç ´å¾Œ N bars å…§å›è½è¦–ç‚ºå‡çªç ´
    min_hold_bars: 24            # æœ€å°‘æŒå€‰ bar æ•¸ï¼ˆ1 å¤©ï¼‰
    trail_exit_mid: true         # ä¸­è»Œæ­¢ç›ˆï¼ˆclose å›ç©¿é€šé“ä¸­ç·šå¹³å€‰ï¼‰

    # â•â•â• Risk / Exit â•â•â•
    stop_loss_atr: 3.5           # ATR æ­¢æå€æ•¸ï¼ˆå¯¬æ­¢æè®“è¶¨å‹¢å¥”è·‘ï¼‰
    take_profit_atr: null        # ä¸ç”¨å›ºå®šæ­¢ç›ˆï¼ˆé ä¸­è»Œé€€å‡ºï¼‰
    trailing_stop_atr: null      # ä¸ç”¨ç§»å‹•æ­¢æï¼ˆé ä¸­è»Œé€€å‡ºï¼‰
    cooldown_bars: 24            # å‡ºå ´å¾Œå†·å» bar æ•¸ï¼ˆ1 å¤©ï¼‰

  symbol_overrides: {}

backtest:
  initial_cash: 10000
  fee_bps: 5
  slippage_bps: 3
  trade_on: "next_open"
  validate_data: true
  clean_data: true

  funding_rate:
    enabled: true
    default_rate_8h: 0.0001
    use_historical: true

  slippage_model:
    enabled: false

risk:
  max_drawdown_pct: 0.30

position_sizing:
  method: "fixed"
  position_pct: 1.0

portfolio:
  cash_reserve: 0
  allocation:
    BTCUSDT: 0.34
    ETHUSDT: 0.33
    SOLUSDT: 0.33

live:
  kline_cache: true
  flip_confirmation: false
  prefer_limit_order: true
  limit_order_timeout_s: 10

notification:
  telegram_bot_token: ${FUTURES_TELEGRAM_BOT_TOKEN}
  telegram_chat_id: ${FUTURES_TELEGRAM_CHAT_ID}
  prefix: "ğŸŸ  [BREAKOUT]"
  enabled: true

output:
  report_dir: "./reports"
