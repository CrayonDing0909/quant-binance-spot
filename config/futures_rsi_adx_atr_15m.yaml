# åˆç´„ç­–ç•¥é…ç½®ï¼šRSI + ADX + ATR â€” 15 åˆ†é˜æ™‚æ¡†
#
# èˆ‡ 1h ç‰ˆæœ¬ç›¸åŒçš„ç­–ç•¥é‚è¼¯ï¼Œèª¿æ•´åƒæ•¸é©é… 15m æ•¸æ“šé »ç‡
# ç”¨æ–¼ Timeframe Migration ç ”ç©¶
#
# ä½¿ç”¨æ–¹å¼ï¼š
#   python scripts/download_data.py -c config/futures_rsi_adx_atr_15m.yaml
#   python scripts/run_backtest.py -c config/futures_rsi_adx_atr_15m.yaml
#   python scripts/run_walk_forward.py -c config/futures_rsi_adx_atr_15m.yaml

market:
  symbols: ["BTCUSDT", "ETHUSDT"]
  interval: "15m"
  start: "2022-01-01"
  end: null
  market_type: "futures"

futures:
  leverage: 5
  margin_type: "ISOLATED"
  position_mode: "ONE_WAY"
  direction: "both"

strategy:
  name: "rsi_adx_atr"
  params:
    # RSI æ¨¡å¼ï¼šdynamic
    rsi_mode: "dynamic"
    rsi_period: 10

    # Dynamic RSI åƒæ•¸
    # 15m æ•¸æ“šï¼š1å¤© = 96 barsï¼Œ14å¤© = 1344 bars
    rsi_lookback_days: 14
    rsi_quantile_low: 0.10
    rsi_quantile_high: 0.90

    # éœæ…‹åƒæ•¸å‚™ä»½
    oversold: 30
    overbought: 80

    # ADX éæ¿¾å™¨
    min_adx: 15
    adx_period: 14

    # Funding Rate éæ¿¾å™¨
    use_funding_filter: true
    fr_max_pos: 0.0002
    fr_max_neg: -0.0002

    # é¢¨æ§
    # 15m æ™‚æ¡†æ­¢æä¿æŒç›¸åŒ ATR å€æ•¸ï¼ˆATR æœ¬èº«æœƒéš¨æ™‚æ¡†è‡ªå‹•èª¿æ•´ï¼‰
    stop_loss_atr: 2.0
    take_profit_atr: null
    atr_period: 14

    # å†·å»æœŸï¼š15m ä¸‹ 12 bars = 3 å°æ™‚ï¼ˆèˆ‡ 1h ä¸‹ 3 bars ç­‰æ•ˆï¼‰
    cooldown_bars: 12

    # æ³¢å‹•ç‡éæ¿¾å™¨
    # 15m æ•¸æ“šæ³¢å‹•ç‡æ›´å°ï¼Œé–¾å€¼éœ€ä¸‹èª¿
    min_atr_ratio: 0.002
    vol_filter_mode: "absolute"

  symbol_overrides: {}

backtest:
  initial_cash: 10000
  fee_bps: 4
  slippage_bps: 3
  trade_on: "next_open"
  validate_data: true
  clean_data: true

  funding_rate:
    enabled: true
    default_rate_8h: 0.0001
    use_historical: true

  slippage_model:
    enabled: true
    base_bps: 2
    impact_coefficient: 0.1
    impact_power: 0.5
    adv_lookback: 80   # 20 bars * 4 (15m â†’ 1h ç­‰æ•ˆ)
    participation_rate: 0.10

risk:
  max_drawdown_pct: 0.65

position_sizing:
  method: "volatility"
  position_pct: 1.0
  kelly_fraction: 0.25
  target_volatility: 0.20
  vol_lookback: 672  # 168 bars(1h) * 4 = 672 bars(15m) = 7å¤©

portfolio:
  cash_reserve: 0
  allocation:
    BTCUSDT: 1.00
    ETHUSDT: 1.00

notification:
  telegram_bot_token: ${FUTURES_TELEGRAM_BOT_TOKEN}
  telegram_chat_id: ${FUTURES_TELEGRAM_CHAT_ID}
  prefix: "ğŸ”´ [FUTURES-15m]"
  enabled: true

output:
  report_dir: "./reports"
