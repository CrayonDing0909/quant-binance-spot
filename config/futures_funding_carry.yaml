# åˆç´„ç­–ç•¥é…ç½®ï¼šFunding Rate Carry
#
# ç­–ç•¥åŸç†ï¼š
#   1. æ­£ funding â†’ å¤šé ­æ“æ“  â†’ åšç©ºæ”¶ funding carry
#   2. è²  funding â†’ ç©ºé ­æ“æ“  â†’ åšå¤šæ”¶ funding carry
#   3. æ³¢å‹•ç‡ç¸®æ”¾ â†’ ä¿å®ˆæ›éšªï¼ˆå¹´åŒ– 10%ï¼‰
#   4. ä½é » rebalanceï¼ˆæ¯ 8hï¼‰â†’ ä½æ›æ‰‹ç‡
#
# è¨­è¨ˆæ€è·¯ï¼ˆèˆ‡ TSMOM/Breakout æ­£äº¤ï¼‰ï¼š
#   - TSMOM è·Ÿéš¨åƒ¹æ ¼è¶¨å‹¢ï¼ˆå‹•é‡å› å­ï¼‰
#   - Breakout æ•æ‰ regime è½‰æ›ï¼ˆçªç ´å› å­ï¼‰
#   - Carry æ•æ‰æŒæœ‰æˆæœ¬å·®ç•°ï¼ˆcarry å› å­ï¼‰
#   - ä¸‰è€…å› å­ä¾†æºä¸åŒ â†’ ä½ç›¸é—œ â†’ çµ„åˆæœ‰æ•ˆ
#
# å¯é¸ç­–ç•¥åï¼š
#   - funding_carry     â€” å–®å¹£ carryï¼ˆæœ‰ funding æ•¸æ“šç”¨çœŸå¯¦ï¼Œç„¡å‰‡ proxyï¼‰
#   - funding_carry_xs  â€” æˆªé¢æ’åº carryï¼ˆå¤šå¹£ç¨®ç›¸å°æ’åï¼‰
#
# ä½¿ç”¨æ–¹å¼ï¼š
#   python scripts/run_backtest.py -c config/futures_funding_carry.yaml
#   python scripts/run_backtest.py -c config/futures_funding_carry.yaml --symbol BTCUSDT
#   python scripts/run_portfolio_backtest.py -c config/futures_funding_carry.yaml
#   python scripts/run_walk_forward.py -c config/futures_funding_carry.yaml --splits 5

market:
  symbols: ["BTCUSDT", "ETHUSDT", "SOLUSDT"]
  interval: "1h"
  start: "2022-01-01"
  end: null
  market_type: "futures"

futures:
  leverage: 3
  margin_type: "ISOLATED"
  position_mode: "ONE_WAY"
  direction: "both"

strategy:
  name: "funding_carry"
  params:
    # â•â•â• Data â•â•â•
    data_dir: "data"

    # â•â•â• Funding Signal â•â•â•
    rolling_window: 72           # funding å¹³æ»‘çª—å£ï¼ˆå°æ™‚ï¼‰ï¼Œ72 = 3 å¤©
    entry_threshold: 0.0001      # å…¥å ´é–€æª»ï¼ˆ0.01%/8h = å¹´åŒ– ~11%ï¼‰
    exit_threshold: 0.00005      # å‡ºå ´é–€æª»
    rebalance_interval: 8        # æ¯ 8h é‡æ–°è©•ä¼°ï¼ˆèˆ‡ funding çµç®—é »ç‡ä¸€è‡´ï¼‰

    # â•â•â• Vol Scaling â•â•â•
    vol_target: 0.10             # ä¿å®ˆæ³¢å‹•ç‡ç›®æ¨™ï¼ˆ10%ï¼‰
    vol_lookback: 168            # 7 å¤© rolling vol

    # â•â•â• Proxyï¼ˆç„¡ funding æ•¸æ“šæ™‚ï¼‰ â•â•â•
    use_proxy: true
    proxy_ema_fast: 24           # 1 å¤© EMA
    proxy_ema_slow: 168          # 7 å¤© EMA
    proxy_threshold: 0.02        # EMA spread 2% é–€æª»

  symbol_overrides: {}

backtest:
  initial_cash: 10000
  fee_bps: 5
  slippage_bps: 3
  trade_on: "next_open"
  validate_data: true
  clean_data: true

  funding_rate:
    enabled: true
    default_rate_8h: 0.0001
    use_historical: true

  slippage_model:
    enabled: false

risk:
  max_drawdown_pct: 0.30

position_sizing:
  method: "fixed"
  position_pct: 1.0

portfolio:
  cash_reserve: 0
  allocation:
    BTCUSDT: 0.34
    ETHUSDT: 0.33
    SOLUSDT: 0.33

live:
  kline_cache: true
  flip_confirmation: false
  prefer_limit_order: true
  limit_order_timeout_s: 10

notification:
  telegram_bot_token: ${FUTURES_TELEGRAM_BOT_TOKEN}
  telegram_chat_id: ${FUTURES_TELEGRAM_CHAT_ID}
  prefix: "ğŸŸ¤ [CARRY]"
  enabled: true

output:
  report_dir: "./reports"
