# å„ªåŒ–ç‰ˆåˆç´„ç­–ç•¥é…ç½®ï¼šRSI + ADX + ATR
# 
# æ”¹å‹•å°æ¯”ï¼ˆvs futures_rsi_adx_atr.yamlï¼‰ï¼š
#
#   å…¨å±€è®Šæ›´ï¼ˆå…©å¹£å…±ç”¨ï¼‰ï¼š
#     - vol_regime_enabled: trueï¼ˆä½æ³¢å‹•æœŸå€‰ä½æ‰“ 5 æŠ˜ï¼‰
#
#   ETH å°ˆå±¬å„ªåŒ–ï¼ˆvia symbol_overridesï¼ŒSOL ä¸å—å½±éŸ¿ï¼‰ï¼š
#     - min_adx: 15 â†’ 20ï¼ˆåšå¤šé–€æª»æé«˜ï¼Œéæ¿¾å¼±è¶¨å‹¢ longï¼ŒPF 1.02 â†’ 1.10ï¼‰
#     - min_hold_bars: 2 â†’ 4ï¼ˆæ¸›å°‘çŸ­å‘½äº¤æ˜“ï¼Œé™ä½æ‰‹çºŒè²»ç£¨æï¼‰
#     - rsi_quantile: 0.10/0.90 â†’ 0.05/0.95ï¼ˆæ›´åš´æ ¼é€²å ´é–€æª»ï¼‰
#
#   å€‰ä½èª¿æ•´ï¼š
#     - ETH: 1.00 â†’ 0.50ï¼ˆETH edge è–„ï¼Œé™ä½æ›éšªï¼‰
#     - SOL: 1.00 ç¶­æŒ
#
# è¨­è¨ˆåŸå‰‡ï¼š
#   SOL Sharpe 1.29 å·²ç¶“å¾ˆå¥½ â†’ ä¸å‹•å®ƒ
#   ETH Sharpe 0.65 éœ€è¦å¹«åŠ© â†’ é‡å°æ€§å„ªåŒ–
#   Regime scaler å°å…©å¹£éƒ½æœ‰æ­£é¢æ•ˆæœ â†’ å…¨å±€å•Ÿç”¨

market:
  symbols: ["ETHUSDT", "SOLUSDT"]
  interval: "1h"
  start: "2022-01-01"
  end: null
  market_type: "futures"

futures:
  leverage: 5
  margin_type: "ISOLATED"
  position_mode: "ONE_WAY"
  direction: "both"

strategy:
  name: "rsi_adx_atr"
  params:
    # === ä»¥ä¸‹å…¨å±€åƒæ•¸ä¿æŒä¸è®Šï¼ˆSOL ç”¨é€™äº›ï¼‰ ===
    rsi_mode: "dynamic"
    rsi_period: 10
    rsi_lookback_days: 14
    rsi_quantile_low: 0.10
    rsi_quantile_high: 0.90
    oversold: 30
    overbought: 80

    min_adx: 15
    short_min_adx: 20
    adx_period: 14

    use_funding_filter: true
    fr_max_pos: 0.0002
    fr_max_neg: -0.0002

    stop_loss_atr: 2.0
    take_profit_atr: null
    atr_period: 14

    adaptive_sl: true
    adaptive_sl_er_period: 10
    er_sl_min: 1.5
    er_sl_max: 2.5

    cooldown_bars: 3
    min_hold_bars: 2

    min_atr_ratio: 0.005
    vol_filter_mode: "absolute"

    htf_interval: "4h"
    htf_mode: "soft"
    htf_ema_fast: 20
    htf_ema_slow: 50
    htf_align_weight: 1.0
    htf_counter_weight: 0.5
    htf_neutral_weight: 0.75

    # ğŸ†• Tier 2: æ³¢å‹•ç‡ Regime å€‰ä½ç¸®æ”¾ï¼ˆå…¨å±€å•Ÿç”¨ï¼‰
    # ä½æ³¢å‹•æœŸå€‰ä½æ‰“æŠ˜ â†’ é™ä½ç£¨æ
    # Regime åˆ†æï¼šé«˜æ³¢å‹• Sharpe æ˜¯ä½æ³¢å‹•çš„ 2-3 å€
    vol_regime_enabled: true
    vol_regime_lookback: 168    # 7 å¤©å›çœ‹
    vol_regime_low_pct: 30.0    # ä½æ–¼ 30th percentile = ä½æ³¢å‹•
    vol_regime_low_weight: 0.5  # ä½æ³¢å‹•æ™‚å€‰ä½ 50%

  # === ETH å°ˆå±¬å„ªåŒ–ï¼ˆSOL ä¸å—å½±éŸ¿ï¼‰===
  symbol_overrides:
    ETHUSDT:
      min_adx: 20               # åšå¤š ADX é–€æª»æé«˜ï¼ˆéæ¿¾å¼±è¶¨å‹¢ longï¼‰
      min_hold_bars: 4          # æ›´é•·æŒå€‰ï¼ˆæ¸›å°‘çŸ­å‘½äº¤æ˜“ï¼‰
      rsi_quantile_low: 0.05    # æ›´åš´æ ¼é€²å ´ï¼ˆåªåšæ¥µç«¯è¶…è³£/è¶…è²·ï¼‰
      rsi_quantile_high: 0.95

backtest:
  initial_cash: 10000
  fee_bps: 4
  slippage_bps: 3
  trade_on: "next_open"
  validate_data: true
  clean_data: true
  funding_rate:
    enabled: true
    default_rate_8h: 0.0001
    use_historical: true
  slippage_model:
    enabled: true
    base_bps: 2
    impact_coefficient: 0.1
    impact_power: 0.5
    adv_lookback: 20
    participation_rate: 0.10

risk:
  max_drawdown_pct: 0.65

position_sizing:
  method: "fixed"
  position_pct: 1.0
  kelly_fraction: 0.25
  target_volatility: 0.50
  vol_lookback: 168

portfolio:
  cash_reserve: 0
  allocation:
    ETHUSDT: 0.50              # â† é™ä½ï¼š1.00 â†’ 0.50ï¼ˆETH edge è–„ï¼‰
    SOLUSDT: 1.00              # SOL å…¨å€‰ä¸å‹•
    # ç¸½æ›éšª 150%ï¼ˆvs åŸæœ¬ 200%ï¼‰

live:
  kline_cache: true
  flip_confirmation: false
  prefer_limit_order: true
  limit_order_timeout_s: 10

notification:
  telegram_bot_token: ${FUTURES_TELEGRAM_BOT_TOKEN}
  telegram_chat_id: ${FUTURES_TELEGRAM_CHAT_ID}
  prefix: "ğŸ”´ [FUTURES]"
  enabled: true

output:
  report_dir: "./reports"
