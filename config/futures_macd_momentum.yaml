# MACD 動量策略 — 合約版
#
# 趨勢跟蹤策略：MACD 交叉 + ADX 過濾 + ATR 止損
# 適合趨勢明顯的行情，與 RSI 策略互補
#
# 使用方式：
#   python scripts/download_data.py -c config/futures_macd_momentum.yaml
#   python scripts/run_backtest.py -c config/futures_macd_momentum.yaml

market:
  symbols: ["BTCUSDT", "ETHUSDT"]
  interval: "1h"
  start: "2022-01-01"
  end: null
  market_type: "futures"

futures:
  leverage: 3
  margin_type: "ISOLATED"
  position_mode: "ONE_WAY"
  direction: "both"

strategy:
  name: "macd_momentum"
  params:
    # MACD 參數
    macd_fast: 12
    macd_slow: 26
    macd_signal: 9
    require_hist_accel: false   # true = 更保守（要求 histogram 加速）

    # ADX 趨勢過濾
    min_adx: 20
    adx_period: 14

    # ATR 止損止盈
    stop_loss_atr: 2.0
    take_profit_atr: 3.0
    trailing_stop_atr: null    # 設 2.5 啟用移動止損
    atr_period: 14
    cooldown_bars: 4

  symbol_overrides:
    ETHUSDT:
      macd_fast: 10             # ETH 波動更快，縮短 MACD 週期
      macd_slow: 21
      min_adx: 18

backtest:
  initial_cash: 10000
  fee_bps: 4
  slippage_bps: 3
  trade_on: "next_open"
  validate_data: true
  clean_data: true

  funding_rate:
    enabled: true
    default_rate_8h: 0.0001
    use_historical: true

  slippage_model:
    enabled: true
    base_bps: 2
    impact_coefficient: 0.1
    impact_power: 0.5
    adv_lookback: 20
    participation_rate: 0.10

risk:
  max_drawdown_pct: 0.50

position_sizing:
  method: "fixed"
  position_pct: 1.0

portfolio:
  cash_reserve: 0
  allocation:
    BTCUSDT: 1.00
    ETHUSDT: 1.00

output:
  report_dir: "./reports"
